<!doctype html>
<title>Angular FP Test</title>

<body ng-app="app">

<input ng-model="name">

<div ng-repeat="name in names()">
  {{ name }}
</div>

<br>
<br>

All the users have cumulatively lived for {{ totalYears() }} years.

<script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.13/angular.js"></script>
<script>
  angular.module('app', []).run(function($rootScope) {
    var users = [
      {
        fname: 'John',
        lname: 'Doe',
        birthdate: 951363573000,
      },
      {
        fname: 'Jeff',
        lname: 'Johnson',
        birthdate: 701408373000,
      },
      {
        fname: 'Jane',
        lname: 'Smith',
        birthdate: 572672373000,
      },
      {
        fname: 'Julie',
        lname: 'Rogers',
        birthdate: 385789173000,
      },
      {
        fname: 'Jackson',
        lname: 'Nelson',
        birthdate: 7097973000,
      },
    ]

    $rootScope.names = function() {
      return users
        .map(function(user) {
          return user.fname + ' ' + user.lname
        })
        .filter(function(name) {
          return !$rootScope.name || name.toLowerCase().indexOf($rootScope.name) !== -1
        })
    }

    $rootScope.totalYears = function() {
      return users
        .map(function(user) {
          return user.birthdate
        })
        .map(function(birthDate) {
          // Don't calculate dates like this
          return (new Date().getTime() - birthDate) / 1000 / 60 / 60 / 24 / 365.25
        })
        .reduce(function(runningTotal, thisPersonsAge) {
          // Becomes new runningTotal
          return runningTotal + thisPersonsAge
        }, 0) // Initial runnintTotal
    }

  })
</script>
